(this["webpackJsonpspaced-repitition"]=this["webpackJsonpspaced-repitition"]||[]).push([[0],{28:function(e,t){},29:function(e,t,n){},30:function(e,t,n){"use strict";n.r(t);n(31);var r,a,o=n(0),s=n.n(o),c=n(16),u=n.n(c),l=n(34),i=n(2),m=n(3),p=n(5),d=n(4),h="https://glacial-eyrie-73604.herokuapp.com/api",f="blogful-client-auth-token",g=n(17),v=n.n(g),E={saveAuthToken(e){window.localStorage.setItem(f,e)},getAuthToken:()=>window.localStorage.getItem(f),clearAuthToken(){window.localStorage.removeItem(f)},hasAuthToken:()=>!!E.getAuthToken(),parseJwt:e=>v()(e),parseAuthToken(){var e=E.getAuthToken();return e?E.parseJwt(e):void 0},_getMsUntilExpiry:e=>1e3*e.exp-Date.now(),queueCallbackBeforeExpiry(e){var t=E._getMsUntilExpiry(E.parseAuthToken());r=setTimeout(e,t-1e4)},clearCallbackBeforeExpiry(){clearTimeout(r)}},b=E,y={postUser:e=>fetch("".concat(h,"/user"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))})),postLogin(e){var t=e.username,n=e.password;return fetch("".concat(h,"/auth/token"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:t,password:n})}).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}))},refreshToken:()=>fetch("".concat(h,"/auth/token"),{method:"PUT",headers:{authorization:"Bearer ".concat(b.getAuthToken())}}).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}))},w=null,j=["mousedown","mousemove","keypress","scroll","touchstart"],k={setIdleCallback(e){w=e},resetIdleTimer(e){clearTimeout(a),a=setTimeout(w,3e5)},regiserIdleTimerResets(){j.forEach((function(e){return document.addEventListener(e,k.resetIdleTimer,!0)}))},unRegisterIdleResets(){clearTimeout(a),j.forEach((function(e){return document.removeEventListener(e,k.resetIdleTimer,!0)}))}},O=k,N=s.a.createContext({user:{},error:null,language:null,score:0,currentWord:{},words:[],nextWord:{},setError:function(){},clearError:function(){},setUser:function(){},processLogin:function(){},processLogout:function(){},setLanguage:function(){},setScore:function(){},setWords:function(){},setNextWord:function(){}}),S=N,x=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var r;Object(i.a)(this,n),(r=t.call(this,e)).setError=function(e){console.error(e),r.setState({error:e})},r.clearError=function(){r.setState({error:null})},r.setUser=function(e){r.setState({user:e})},r.setLanguage=function(e){return r.setState({language:e})},r.setScore=function(e){return r.setState({score:e})},r.setWords=function(e){return r.setState({words:e})},r.setNextWord=function(e){return r.setState({nextWord:e})},r.processLogin=function(e){b.saveAuthToken(e);var t=b.parseAuthToken();r.setUser({id:t.user_id,name:t.name,username:t.sub}),O.regiserIdleTimerResets(),b.queueCallbackBeforeExpiry((function(){r.fetchRefreshToken()}))},r.processLogout=function(){b.clearAuthToken(),b.clearCallbackBeforeExpiry(),O.unRegisterIdleResets(),r.setUser({})},r.logoutBecauseIdle=function(){b.clearAuthToken(),b.clearCallbackBeforeExpiry(),O.unRegisterIdleResets(),r.setUser({idle:!0})},r.fetchRefreshToken=function(){y.refreshToken().then((function(e){b.saveAuthToken(e.authToken),b.queueCallbackBeforeExpiry((function(){r.fetchRefreshToken()}))})).catch((function(e){r.setError(e)}))};var a={user:{},error:null,language:null,nextWord:{},score:0,words:[]},o=b.parseAuthToken();return o&&(a.user={id:o.user_id,name:o.name,username:o.sub}),r.state=a,O.setIdleCallback(r.logoutBecauseIdle),r}return Object(m.a)(n,[{key:"componentDidMount",value:function(){var e=this;b.hasAuthToken()&&(O.regiserIdleTimerResets(),b.queueCallbackBeforeExpiry((function(){e.fetchRefreshToken()})))}},{key:"componentWillUnmount",value:function(){O.unRegisterIdleResets(),b.clearCallbackBeforeExpiry()}},{key:"render",value:function(){var e={user:this.state.user,error:this.state.error,language:this.state.language,words:this.state.words,nextWord:this.state.nextWord,score:this.state.score,setError:this.setError,clearError:this.clearError,setUser:this.setUser,processLogin:this.processLogin,processLogout:this.processLogout,setLanguage:this.setLanguage,setScore:this.setScore,setWords:this.setWords,setNextWord:this.setNextWord};return s.a.createElement(N.Provider,{value:e},this.props.children)}}]),n}(o.Component),T=n(36),C=n(35),L=n(32),W=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).handleLogoutClick=function(){e.context.processLogout()},e}return Object(m.a)(n,[{key:"renderLogoutLink",value:function(){return s.a.createElement("div",{className:"nav-wrapper"},s.a.createElement("span",{className:"username"},s.a.createElement("p",null,"Welcome, ",this.context.user.name,"! ")),s.a.createElement("nav",{className:"nav"},s.a.createElement(L.a,{onClick:this.handleLogoutClick,to:"/login"},"Logout")))}},{key:"renderLoginLink",value:function(){return s.a.createElement("div",{className:"nav-wrapper"},s.a.createElement("nav",null,s.a.createElement(L.a,{to:"/login"},"Login")," ",s.a.createElement(L.a,{to:"/register"},"Sign up")))}},{key:"render",value:function(){return s.a.createElement("header",{className:"Header"},s.a.createElement("h1",null,s.a.createElement(L.a,{to:"/"},"Spaced Repetition")),b.hasAuthToken()?this.renderLogoutLink():this.renderLoginLink())}}]),n}(o.Component);W.contextType=S;var A=W,P=n(9),I=n(33);function R(e){var t=e.component,n=Object(P.a)(e,["component"]),r=t;return s.a.createElement(C.a,Object.assign({},n,{render:function(e){return s.a.createElement(S.Consumer,null,(function(t){return t.user.id?s.a.createElement(r,e):s.a.createElement(I.a,{to:{pathname:t.user.idle?"/login":"/register",state:{from:e.location}}})}))}}))}function D(e){var t=e.component,n=Object(P.a)(e,["component"]),r=t;return s.a.createElement(C.a,Object.assign({},n,{render:function(e){return s.a.createElement(S.Consumer,null,(function(t){return t.user.id?s.a.createElement(I.a,{to:"/"}):s.a.createElement(r,e)}))}}))}var U=n(11),B=n.n(U);function q(e){var t=e.className,n=Object(P.a)(e,["className"]);return s.a.createElement("label",Object.assign({className:B()("Label",t)},n))}var G=s.a.forwardRef((function(e,t){var n=e.className,r=Object(P.a)(e,["className"]);return s.a.createElement("input",Object.assign({className:B()("Input",n),type:"text",ref:t},r))}));function F(e){var t=e.className,n=Object(P.a)(e,["className"]);return s.a.createElement("span",Object.assign({className:B()("Required",t)},n),"*")}var J=s.a.forwardRef((function(e,t){var n=e.className,r=Object(P.a)(e,["className"]);return s.a.createElement("button",Object.assign({className:B()("Button",n),ref:t},r))})),M=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={error:null},e.firstInput=s.a.createRef(),e.handleSubmit=function(t){t.preventDefault();var n=t.target,r=n.name,a=n.username,o=n.password;y.postUser({name:r.value,username:a.value,password:o.value}).then((function(t){r.value="",a.value="",o.value="",e.props.onRegistrationSuccess()})).catch((function(t){e.setState({error:t.error})}))},e}return Object(m.a)(n,[{key:"componentDidMount",value:function(){this.firstInput.current.focus()}},{key:"render",value:function(){var e=this.state.error;return s.a.createElement("form",{onSubmit:this.handleSubmit},s.a.createElement("div",{className:"alert",role:"alert"},e&&s.a.createElement("p",null,e)),s.a.createElement("div",{className:"signin-form"},s.a.createElement(q,{htmlFor:"registration-name-input"},"Enter your name",s.a.createElement(F,null)),s.a.createElement(G,{ref:this.firstInput,id:"registration-name-input",name:"name",required:!0})),s.a.createElement("div",{className:"signin-form"},s.a.createElement(q,{htmlFor:"registration-username-input"},"Choose a username",s.a.createElement(F,null)),s.a.createElement(G,{id:"registration-username-input",name:"username",required:!0})),s.a.createElement("div",{className:"signin-form"},s.a.createElement(q,{htmlFor:"registration-password-input"},"Choose a password",s.a.createElement(F,null)),s.a.createElement(G,{id:"registration-password-input",name:"password",type:"password",required:!0})),s.a.createElement("footer",null,s.a.createElement(J,{className:"signin",type:"submit"},"Sign up")," ",s.a.createElement(L.a,{to:"/login"},"Already have an account?")))}}]),n}(o.Component);M.defaultProps={onRegistrationSuccess:function(){}};var _=M,Y=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).handleRegistrationSuccess=function(){e.props.history.push("/login")},e}return Object(m.a)(n,[{key:"render",value:function(){return s.a.createElement("section",{className:"registration"},s.a.createElement("p",{className:"reg-p"},"Practice learning a language with the spaced reptition revision technique."),s.a.createElement("div",{className:"wrapper"},s.a.createElement("h2",null,"Sign up"),s.a.createElement(_,{onRegistrationSuccess:this.handleRegistrationSuccess})))}}]),n}(o.Component);Y.defaultProps={history:{push:function(){}}};var z=Y,H=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={error:null},e.firstInput=s.a.createRef(),e.handleSubmit=function(t){t.preventDefault();var n=t.target,r=n.username,a=n.password;e.setState({error:null}),y.postLogin({username:r.value,password:a.value}).then((function(t){r.value="",a.value="",e.context.processLogin(t.authToken),e.props.onLoginSuccess()})).catch((function(t){e.setState({error:t.error})}))},e}return Object(m.a)(n,[{key:"componentDidMount",value:function(){this.firstInput.current.focus()}},{key:"render",value:function(){var e=this.state.error;return s.a.createElement("form",{className:"LoginForm",onSubmit:this.handleSubmit},s.a.createElement("div",{className:"alert",role:"alert"},e&&s.a.createElement("p",null,e)),s.a.createElement("div",null,s.a.createElement(q,{htmlFor:"login-username-input"},"Username"),s.a.createElement(G,{ref:this.firstInput,id:"login-username-input",name:"username",required:!0})),s.a.createElement("div",null,s.a.createElement(q,{htmlFor:"login-password-input"},"Password"),s.a.createElement(G,{id:"login-password-input",name:"password",type:"password",required:!0})),s.a.createElement(J,{type:"submit"},"Login"))}}]),n}(o.Component);H.defaultProps={onLoginSuccess:function(){}},H.contextType=S;var K=H,$=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).handleLoginSuccess=function(){var t=e.props,n=t.location,r=t.history,a=(n.state||{}).from||"/";r.push(a)},e}return Object(m.a)(n,[{key:"render",value:function(){return s.a.createElement("section",null,s.a.createElement("div",{className:"wrapper"},s.a.createElement("h2",null,"Login"),s.a.createElement(K,{onLoginSuccess:this.handleLoginSuccess})))}}]),n}(o.Component);$.defaultProps={location:{},history:{push:function(){}}};var Q=$,V={getUserData:()=>fetch("".concat(h,"/language"),{headers:{Authorization:"bearer ".concat(b.getAuthToken())}}).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))})),getWordCard:()=>fetch("".concat(h,"/language/head"),{headers:{Authorization:"bearer ".concat(b.getAuthToken())}}).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))})),sendGuess:e=>fetch("".concat(h,"/language/guess"),{method:"POST",headers:{"content-type":"application/json",Authorization:"bearer ".concat(b.getAuthToken())},body:JSON.stringify({guess:e})}).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}))},X=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props.word;return s.a.createElement("div",{className:"word"},s.a.createElement("ul",null,s.a.createElement("li",null,s.a.createElement("h4",null,e.original),s.a.createElement("p",null,"correct answer count: ",e.correct_count),s.a.createElement("p",null," incorrect answer count: ",e.incorrect_count))))}}]),n}(o.Component);X.contextType=S;var Z=X,ee=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"renderWords",value:function(){return this.context.words.map((function(e,t){return s.a.createElement(Z,{key:t,word:e})}))}},{key:"render",value:function(){return s.a.createElement("div",{className:"wordlist-div"},0===this.context.words.length?s.a.createElement("div",{className:"list"},s.a.createElement("p",null,"No Words found for this language")):s.a.createElement("div",{className:"list"},this.renderWords()))}}]),n}(o.Component);ee.contextType=S;var te=ee,ne=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={width:"".concat(e.context.score,"%")},e}return Object(m.a)(n,[{key:"componentDidMount",value:function(){var e=this;V.getUserData().then((function(t){e.context.setLanguage(t.language.name),e.context.setScore(t.language.total_score),e.context.setWords(t.words)}))}},{key:"render",value:function(){return s.a.createElement("section",{className:"dashboard-main"},s.a.createElement("div",{className:"dashboard-header"},s.a.createElement("h2",null,this.context.language),s.a.createElement("p",null,"Total correct answers: ",this.context.score),s.a.createElement(L.a,{className:"btn",to:"/learn"},"Start practicing"),s.a.createElement("h3",null,"Words to practice")),s.a.createElement(te,null))}}]),n}(o.Component);ne.contextType=S;var re=ne,ae=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).handleSubmit=function(t){t.preventDefault();var n=e.props.guess.toLowerCase();V.sendGuess(n).then((function(t){return e.context.setNextWord(t)})),e.props.setPrompt()},e.firstInput=s.a.createRef(),e}return Object(m.a)(n,[{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)},className:"guess-form"},s.a.createElement(q,{htmlFor:"learn-guess-input"},"What does this Patwa word mean in english?"),s.a.createElement(G,{ref:this.firstInput,id:"learn-guess-input",required:!0,onChange:function(t){return e.props.setGuess(t)}}),s.a.createElement(J,{type:"submit",disabled:""===this.props.guess},"Submit")))}}]),n}(o.Component);ae.contextType=S;var oe=ae,se=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props,t=e.word,n=e.setPrompt,r=e.guess,a=e.setGuess;return s.a.createElement("div",{className:"learn-card"},s.a.createElement("h2",{className:"learn-header"},"Translate the word:"),s.a.createElement("span",{className:"word-container"},t.nextWord),s.a.createElement("section",null,s.a.createElement(oe,{word:t,setPrompt:n,guess:r,setGuess:a}),s.a.createElement("div",{className:"DisplayScore-card DisplayScore"},s.a.createElement("p",null,"Your total score is: ",t.totalScore),s.a.createElement("p",null," ","You have answered this word correctly ",t.wordCorrectCount," ","times."),s.a.createElement("p",null," ","You have answered this word incorrectly ",t.wordIncorrectCount," ","times."))))}}]),n}(o.Component),ce=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).renderCorrect=function(){var t=e.props,n=t.word,r=t.guess;return s.a.createElement("div",{className:"correct"},s.a.createElement("h2",{className:"learn-header"},"Correct"),s.a.createElement("div",{className:"DisplayFeedback"},s.a.createElement("p",null,n.nextWord," means: ",r)),s.a.createElement("div",{className:"DisplayScore"},s.a.createElement("p",null,"Your current score is: ",e.context.nextWord.totalScore)))},e.renderIncorrect=function(){var t=e.props,n=t.word,r=t.guess;return s.a.createElement("div",{className:"incorrect"},s.a.createElement("h2",{className:"learn-header"},"Keep trying!"),s.a.createElement("div",{className:"DisplayFeedback"},s.a.createElement("p",null,n.nextWord," actually means: ",e.context.nextWord.answer,'. You tried "',r,'".')),s.a.createElement("div",{className:"DisplayScore"},s.a.createElement("p",null,"Your current score is: ",e.context.nextWord.totalScore)))},e.handleNext=function(){e.props.clearPrompt(),e.props.clearGuess(),e.props.setNewWord(e.context.nextWord)},e}return Object(m.a)(n,[{key:"render",value:function(){var e=this;return s.a.createElement("div",null,!0===this.context.nextWord.isCorrect?this.renderCorrect():this.renderIncorrect(),s.a.createElement(J,{onClick:function(){return e.handleNext()}},"Next word"))}}]),n}(o.Component);ce.contextType=S;var ue=ce,le=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={word:{},err:"",prompt:null,guess:""},e.setPrompt=function(){e.setState({prompt:!0})},e.setGuess=function(t){e.setState({guess:t.target.value})},e.clearPrompt=function(){e.setState({prompt:null})},e.clearGuess=function(){e.setState({guess:""})},e.setNewWord=function(t){e.setState({word:t})},e.renderPrompt=function(){if(!0===e.state.prompt)return s.a.createElement(ue,{word:e.state.word,guess:e.state.guess,clearGuess:e.clearGuess,clearPrompt:e.clearPrompt,setNewWord:e.setNewWord})},e}return Object(m.a)(n,[{key:"componentDidMount",value:function(){var e=this;V.getWordCard().then((function(t){return e.setState({word:t})})).catch((function(t){return e.setState({err:t})}))}},{key:"render",value:function(){return s.a.createElement("section",null,!0===this.state.prompt?this.renderPrompt():s.a.createElement(se,{word:this.state.word,score:this.state.score,guess:this.state.guess,setPrompt:this.setPrompt,setGuess:this.setGuess}))}}]),n}(o.Component),ie=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){return s.a.createElement("section",{id:"not-found"},s.a.createElement("h2",null,"404 - Page not found"),s.a.createElement("p",null,"Try going back to your previous page."))}}]),n}(o.Component),me=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={hasError:!1},e}return Object(m.a)(n,[{key:"render",value:function(){var e=this.state.hasError;return s.a.createElement("div",{className:"App"},s.a.createElement(A,null),s.a.createElement("main",null,s.a.createElement("div",{className:"main"},e&&s.a.createElement("p",null,"There was an error! Oh no!"),s.a.createElement(T.a,null,s.a.createElement(R,{exact:!0,path:"/",component:re}),s.a.createElement(R,{path:"/learn",component:le}),s.a.createElement(D,{path:"/register",component:z}),s.a.createElement(D,{path:"/login",component:Q}),s.a.createElement(C.a,{component:ie})))))}}],[{key:"getDerivedStateFromError",value:function(e){return console.error(e),{hasError:!0}}}]),n}(o.Component);n(28),n(29),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(s.a.createElement(l.a,null,s.a.createElement(x,null,s.a.createElement(me,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[30,1,2]]]);
//# sourceMappingURL=main.9bdd0a90.chunk.js.map